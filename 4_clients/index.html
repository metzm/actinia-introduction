<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="canonical" href="https://pages.gitlab.io/actinia-introduction/4_clients/">
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Client implementations - A gentle introduction to actinia</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  <link href="../extra.css" rel="stylesheet" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Client implementations";
    var mkdocs_page_input_path = "4_clients.md";
    var mkdocs_page_url = "/actinia-introduction/4_clients/";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> A gentle introduction to actinia</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="..">A gentle introduction to actinia</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../2_concepts/">Concepts of actinia, cloud computing, REST API</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../3_explore/">Explore</a>
                    </li>
                </ul>
                <ul class="current">
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Client implementations</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#ace-controlling-actinia-from-a-running-grass-gis-session">ACE - Controlling actinia from a running GRASS GIS session</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#introduction-to-ace-actinia-command-execution">Introduction to ace - actinia command execution</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#preparation">Preparation</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#authentication-settings">Authentication settings</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#list-locations-mapsets-and-maps">List locations, mapsets and maps</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#command-line-examples">Command line examples</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#script-examples">Script examples</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#example-orthophoto-image-segmentation-with-export">Example: Orthophoto image segmentation with export</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#actinia-connector-a-qgis-plugin">actinia Connector - a QGIS plugin</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#introduction-to-the-actinia-connector">Introduction to the actinia Connector</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#project-setup">Project Setup</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#location-management">Location management</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#mapset-management">Mapset management</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#raster-management">Raster management</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#vector-management">Vector management</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#persistent-and-ephemeral-processing">Persistent and Ephemeral processing</a>
    </li>
        </ul>
    </li>
    </ul>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../5_jupyter/">actinia in jupyter notebooks</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../6_conclusions/">Conclusions and future</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../about/">About the trainers</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">A gentle introduction to actinia</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Client implementations</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="client-implementations">Client implementations</h1>
<!--
(duration: 20 min)
-->

<h2 id="ace-controlling-actinia-from-a-running-grass-gis-session">ACE - Controlling actinia from a running GRASS GIS session</h2>
<h3 id="introduction-to-ace-actinia-command-execution">Introduction to ace - actinia command execution</h3>
<p>Controlling actinia from a running GRASS GIS session is a convenient way of writing process chains. It requires some basic GRASS GIS knowledge (for an intro course, e.g. see <a href="https://neteler.gitlab.io/grass-gis-analysis/">here</a>).</p>
<p>The <code>ace</code> (actinia command execution) tool allows the execution of a single GRASS GIS command or a list of GRASS GIS commands on an actinia REST service (e.g., https://actinia.mundialis.de/). In addition it provides job management, the ability to list locations, mapsets and map layer the user has access to as well as the creation and deletion of mapsets. The <code>ace</code> tool is a GRASS GIS addon and must be executed in an active GRASS GIS session.</p>
<p>All commands will be executed per default in an <strong>ephemeral</strong> database on the actinia server. Hence, generated output must be exported using augmented GRASS commands to be able to further use it.</p>
<p>Note: The option <code>mapset=MAPSET_NAME</code> allows the execution of commands in the <strong>persistent</strong> user database. It can be used with <code>location=LOCATION_NAME</code>option.</p>
<h3 id="preparation">Preparation</h3>
<p>To use ace, some things are required:</p>
<ul>
<li>GRASS GIS 7.8+ (<a href="https://grass.osgeo.org/download/">download</a>)</li>
<li>three additional Python packages: <code>click</code> <code>requests</code> <code>simplejson</code></li>
</ul>
<pre><code>pip3 install click requests simplejson
</code></pre>
<ul>
<li><code>nc_spm_08</code> North Carolina sample location</li>
<li>An empty test mapset <code>ace</code> (only for demo)</li>
</ul>
<pre><code>grass -c nc_spm_08/ace
</code></pre>
<ul>
<li><code>ace</code> itself, <code>importer</code> and <code>exporter</code>  tools as GRASS GIS extensions</li>
</ul>
<pre><code>g.extension extension=importer url=https://github.com/mundialis/importer
g.extension extension=exporter url=https://github.com/mundialis/exporter
g.extension extension=ace url=https://github.com/mundialis/ace
</code></pre>
<p>For more detailed information on how to set this up yourself, see <a href="https://neteler.gitlab.io/actinia-introduction/#preparation_1">different actinia workshop</a>.</p>
<h3 id="authentication-settings">Authentication settings</h3>
<p>The user must setup the following environmental variables to specify the actinia server and credentials:</p>
<pre><code class="language-bash"># set credentials and REST server URL
export ACTINIA_USER='demouser'
export ACTINIA_PASSWORD='gu3st!pa55w0rd'
export ACTINIA_URL='https://actinia.mundialis.de/'
</code></pre>
<h3 id="list-locations-mapsets-and-maps">List locations, mapsets and maps</h3>
<p>In order to list the locations the user has access to, run</p>
<pre><code class="language-bash">ace -l
['latlong_wgs84', 'nc_spm_08', 'ECAD']
</code></pre>
<p>The following command lists mapsets of current location in the active GRASS GIS session ("nc_spm_08"):</p>
<pre><code class="language-bash"># running ace in the &quot;nc_spm_08&quot; location on server:
ace location=&quot;nc_spm_08&quot; -m
['PERMANENT', 'landsat', 'modis_lst']
</code></pre>
<p>All following commands can be executed in any active GRASS GIS location, since the location name at the actinia server is explicitly provided. In case the location option is not provided, the active location will be used. The following command lists mapsets of the provided location <strong>latlong_wgs84</strong>:</p>
<pre><code class="language-bash">ace location=&quot;latlong_wgs84&quot; -m
['PERMANENT', 'Sentinel2A', 'globcover', 'modis_ndvi_global']
</code></pre>
<p>but only if the actinia user is enabled; otherwise the following message appears:</p>
<pre><code class="language-bash">ace location=&quot;latlong_wgs84&quot; -m
{'message': &quot;{'Status': 'error', 'Messages': 'Unauthorized access to location &quot;
            &quot;&lt;latlong_wgs84&gt;'}&quot;}
</code></pre>
<p>To list all raster maps available in the specified mapset belonging to the provided location <strong>nc_spm_08</strong>, run:</p>
<pre><code class="language-bash">ace location=&quot;nc_spm_08&quot; mapset=&quot;PERMANENT&quot; -r
['aspect',
 'basin_50K',
 'boundary_county_500m',
 'cfactorbare_1m',
 'cfactorgrow_1m',
...
 'urban',
 'zipcodes',
 'zipcodes_dbl']
</code></pre>
<h3 id="command-line-examples">Command line examples</h3>
<p>Running the module <code>g.region</code> in a new ephemeral location, to show the default region of a temporary mapset:</p>
<pre><code class="language-bash">ace location=&quot;nc_spm_08&quot; grass_command=&quot;g.region -p&quot;

Resource status accepted
Polling: https://actinia.mundialis.de/api/v3/resources/demouser/resource_id-b398b4dd-a47c-4443-a07d-7814cc737973
Resource poll status: finished
Processing successfully finished
Resource status finished
--------------------------------------------------------------------------
projection: 99 (Lambert Conformal Conic)
zone:       0
datum:      nad83
ellipsoid:  a=6378137 es=0.006694380022900787
north:      320000
south:      10000
west:       120000
east:       935000
nsres:      500
ewres:      500
rows:       620
cols:       1630
cells:      1010600

{'resources': [],
 'status': 'https://actinia.mundialis.de/api/v3/resources/demouser/resource_id-b398b4dd-a47c-4443-a07d-7814cc737973'}
</code></pre>
<h3 id="script-examples">Script examples</h3>
<h4 id="example-orthophoto-image-segmentation-with-export">Example: Orthophoto image segmentation with export</h4>
<p>Store the following script as text file <code>/tmp/ace_segmentation.sh</code>:</p>
<pre><code class="language-bash"># grass78 ~/grassdata/nc_spm_08/user1/
# Import the web resource and set the region to the imported map
# we apply a trick for the import of multi-band GeoTIFFs:
# install with: g.extension importer
importer raster=ortho2010@https://apps.mundialis.de/workshops/osgeo_ireland2017/north_carolina/ortho2010_t792_subset_20cm.tif
# The importer has created three new raster maps, one for each band in the geotiff file
# stored them in an image group
r.info map=ortho2010.1
r.info map=ortho2010.2
r.info map=ortho2010.3
# Set the region and resolution
g.region raster=ortho2010.1 res=1 -p
# Note: the RGB bands are organized as a group
i.segment group=ortho2010 threshold=0.25 output=ortho2010_segment_25+GTiff goodness=ortho2010_seg_25_fit+GTiff
# Finally vectorize segments with r.to.vect and export as a GeoJSON file
r.to.vect input=ortho2010_segment_25 type=area output=ortho2010_segment_25+GeoJSON
</code></pre>
<p>Run the script saved in a text file as</p>
<pre><code class="language-bash">ace location=&quot;nc_spm_08&quot; script=&quot;/tmp/ace_segmentation.sh&quot;
</code></pre>
<p>The results are provided as REST resources for download or consumtion in other systems.</p>
<p><a href="../img/ortho2010.jpeg"><img src="../img/ortho2010.jpeg" width="100%"></a><br>
Fig. 9: actinia output maps. From left to right: "ortho2010_segment_25.tif", "ortho2010_seg_25_fit.tif", "ortho2010_segment_25.geojson"</p>
<p style="border:lightgreen solid 5px;padding:5px; width:80%">
If you want to try out more things with ace, take a look at a <a href="https://neteler.gitlab.io/actinia-introduction/#preparation_1">different actinia workshop</a> where a more in-depth look is taken on this topic.
</p>

<h2 id="actinia-connector-a-qgis-plugin">actinia Connector - a QGIS plugin</h2>
<h3 id="introduction-to-the-actinia-connector">Introduction to the actinia Connector</h3>
<p>The actinia Connector is a QGIS Plugin for actinia communication. With it it is possible to connect to a
running actinia instance, request locations, mapsets and detailed layer information.
It is also possible to download maps directly into QGIS for local processing and even
to start processes. For ephemeral processing the plugin downloads the results directly.</p>
<p>This is still a development version but can be tested and used already.</p>
<p>Download is available from <a href="https://apps.mundialis.de/actinia_connector/plugins.xml">https://apps.mundialis.de/actinia_connector/plugins.xml</a></p>
<h3 id="project-setup">Project Setup</h3>
<p>In the actinia Connector plugin you can create a new project or load an old one.</p>
<p>When a new project is created, a new project file is created. The user can set a project name and a data directory, where data created by the plugin are saved.
Additional the actinia settings have to be set. These settings are the base url, user and password. As simple example you can select the https://actinia.mundialis.de/ with the demouser and password gu3st!pa55w0rd. But you can also use another actinia server or one you have set up yourself.</p>
<p><a href="../img/ac_project_setup.jpg"><img src="../img/ac_project_setup.jpg" width="60%"></a><br>
Fig. 10: actinia connector, project setup</p>
<h3 id="location-management">Location management</h3>
<p>In the location management screen you can query all locations available for you with the “Get locations” button and then select a location and query its information with the “Get selected location info (region and projection)” button or use this location in another tab for another functionality.</p>
<p><a href="../img/ac_01_location_management.jpg"><img src="../img/ac_01_location_management.jpg" width="60%"></a><br>
Fig. 11: actinia connector, location management</p>
<h3 id="mapset-management">Mapset management</h3>
<p>For mapset management a selected location (in the location tab) is required. From this location all mapsets available for the user can be queried with the “Get mapsets” button.</p>
<p>When selecting one of these mapsets, information can be queried with the “Get selected mapset info (region and projection)” button or the layer in this mapset can be used in the raster maps or vector maps tab.</p>
<p><a href="../img/ac_02_mapset_management.jpg"><img src="../img/ac_02_mapset_management.jpg" width="60%"></a><br>
Fig. 12: actinia connector, mapset management</p>
<h3 id="raster-management">Raster management</h3>
<p>For raster management, both a location and a mapset must be selected (these are displayed again at the top). With the “Get raster maps” button all raster layers can be listed.</p>
<p>If you select one of them, you can query the map information for it using the “Get selected raster map info” or import the raster map into QGIS.
There are two ways to import a raster layer into QGIS. One is to simply use the button “Import selected raster map into QGIS” to import the entire raster map. There is also another possibility to select a layer in QGIS and then additionally select the radio button “by selected layer extent” to limit the extent of the raster map to be imported to the extent of the selected raster map. This extent can also be increased by a number of cells. However, care must be taken that the two maps overlap, otherwise an empty map will be imported into QGIS.</p>
<p><a href="../img/ac_03_raster_management.jpg"><img src="../img/ac_03_raster_management.jpg" width="60%"></a><br>
Fig. 13: actinia connector, raster management</p>
<h3 id="vector-management">Vector management</h3>
<p>For vector management, both a location and a mapset must be selected (these are displayed again at the top). With the “Get vector maps” button all vector layers can be listed.</p>
<p>If you select one of them, you can query the map information for it using the “Get selected vector map info” or import the vector map into QGIS with the “Import selected vector map into QGIS” button.</p>
<p><a href="../img/ac_04_vector_management.jpg"><img src="../img/ac_04_vector_management.jpg" width="60%"></a><br>
Fig. 14: actinia connector, vector management</p>
<h3 id="persistent-and-ephemeral-processing">Persistent and Ephemeral processing</h3>
<p>For processing, a location must be selected (in the location tab). Via “Load process chain” a process chain can be uploaded as a file. This is then displayed on the right.</p>
<p>Before the processing can be started, the process type must also be selected. The process can be started as ephermeral or persistent process.
If persistent processing is used, a mapset name must be entered in the empty text field. This can be a simple text e.g. “mapset_XY”. The mapset with this name is then created during the processing, and can be loaded afterwards via the tab mapsets.</p>
<p><a href="../img/ac_05_processing.jpg"><img src="../img/ac_05_processing.jpg" width="60%"></a><br>
Fig. 15: actinia connector, persistent and ephemeral processing</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../5_jupyter/" class="btn btn-neutral float-right" title="actinia in jupyter notebooks">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../3_explore/" class="btn btn-neutral" title="Explore"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../3_explore/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../5_jupyter/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
